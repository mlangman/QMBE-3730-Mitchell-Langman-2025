import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Load the dataset
file_path = '/mnt/data/netflix_titles (1).csv'
df = pd.read_csv(file_path)

# Display shape of dataset
print("Shape of dataset:", df.shape)

# Display column names and data types
print("\nColumn Names and Data Types:")
print(df.dtypes)

# Check for missing values
missing_values = df.isnull().sum()
print("\nMissing Values:")
print(missing_values[missing_values > 0])

# Visualize missing values
plt.figure(figsize=(10, 6))
sns.heatmap(df.isnull(), cmap='viridis', cbar=False, yticklabels=False)
plt.title("Missing Data Heatmap")
plt.show()

# Summary statistics for numerical columns
print("\nSummary Statistics:")
print(df.describe())

# Visualize distribution of categorical features
plt.figure(figsize=(10, 5))
sns.countplot(data=df, x='type', palette='coolwarm')
plt.title("Distribution of Show Types")
plt.show()

# Display top 10 most common genres
if 'listed_in' in df.columns:
    genres = df['listed_in'].str.split(', ').explode()
    plt.figure(figsize=(12, 6))
    sns.countplot(y=genres, order=genres.value_counts().index[:10], palette='magma')
    plt.title("Top 10 Most Common Genres")
    plt.show()
